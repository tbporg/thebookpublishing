!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"undefined"!=typeof exports?module.exports=e(require("jquery")):e(jQuery)}((function(e){"use strict";var a=window.EvoCalendar||{};(a=function(a,t){var n=this;if(n.defaults={format:"mm/dd/yyyy",titleFormat:"MM yyyy",eventHeaderFormat:"MM d, yyyy",language:"en",todayHighlight:!1,sidebarToggler:!0,eventListToggler:!0,calendarEvents:null,canAddEvent:!0,onSelectDate:null,onAddEvent:null},n.initials={validParts:/dd?|DD?|mm?|MM?|yy(?:yy)?/g,dates:{en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}}},n.options=e.extend({},n.defaults,t),null!=n.options.calendarEvents)for(var r=0;r<n.options.calendarEvents.length;r++)n.isValidDate(n.options.calendarEvents[r].date)&&(n.options.calendarEvents[r].date=n.formatDate(new Date(n.options.calendarEvents[r].date),n.options.format,"en"));console.log(n.options),n.$cal_days_labels=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],n.$cal_months_labels=["January","February","March","April","May","June","July","August","September","October","November","December"],n.$cal_days_in_month=[31,28,31,30,31,30,31,31,30,31,30,31],n.$cal_current_date=new Date,n.$month=isNaN(n.$month)||null==n.$month?n.$cal_current_date.getMonth():n.$month,n.$year=isNaN(n.$year)||null==n.$year?n.$cal_current_date.getFullYear():n.$year,n.$mainHTML="",n.$sidebarHTML="",n.$calendarHTML="",n.$eventHTML="",n.$active_day_el=null,n.$active_date=n.formatDate(new Date,n.options.format,"en"),n.$active_month_el=null,n.$active_month=n.$month,n.$active_year_el=null,n.$active_year=n.$year,n.$calendar=e(a),n.$calendar_sidebar="",n.$calendar_inner="",n.$calendar_events="",n.selectDate=e.proxy(n.selectDate,n),n.selectMonth=e.proxy(n.selectMonth,n),n.selectYear=e.proxy(n.selectYear,n),n.toggleSidebar=e.proxy(n.toggleSidebar,n),n.toggleEventList=e.proxy(n.toggleEventList,n),n.parseFormat=e.proxy(n.parseFormat,n),n.formatDate=e.proxy(n.formatDate,n),n.init(!0)}).prototype.init=function(a){var t=this;e(t.$calendar).hasClass("calendar-initialized")||(e(t.$calendar).addClass("evo-calendar calendar-initialized"),t.buildCalendar("all"))},a.prototype.buildCalendar=function(e,a,t){var n=this;a=isNaN(a)||null==a?n.$active_month:a,t=isNaN(t)||null==t?n.$active_year:t;var r=new Date(t,a).getDay(),l=n.$cal_days_in_month[a];1==a&&(t%4==0&&t%100!=0||t%400==0)&&(l=29);var i=n.$cal_months_labels[a],o="",s="";function d(){o='<div class="calendar-year"><button class="icon-button" year-val="prev" title="Previous year"><span class="chevron-arrow-left"></span></button>&nbsp;<p>'+t+'&nbsp;</p><button class="icon-button" year-val="next" title="Next year"><span class="chevron-arrow-right"></span></button></div>',o+='<ul class="calendar-months">';for(var e=0;e<n.$cal_months_labels.length;e++)o+='<li class="month',o+=parseInt(n.$active_month)===e?" active-month":"",o+='" month-val="'+e+'">'+n.$cal_months_labels[e]+"</li>";o+="</ul>",n.options.sidebarToggler&&(o+='<span id="sidebarToggler" title="Close sidebar"><button class="icon-button"><span class="bars"></span></button></span>'),n.$sidebarHTML=o}function c(){s='<table class="calendar-table">',s+='<tr><th colspan="7">',s+=n.formatDate(new Date(i+" "+t),n.options.titleFormat,"en"),s+="</th></tr>",s+='<tr class="calendar-header">';for(var e=0;e<=6;e++)s+='<td class="calendar-header-day">',s+=n.$cal_days_labels[e],s+="</td>";s+='</tr><tr class="calendar-body">';var a=1;for(e=0;e<9;e++){for(var o=0;o<=6;o++){if(s+='<td class="calendar-day">',a<=l&&(e>0||o>=r)){var d=n.formatDate(new Date(i+"/"+a+"/"+t),n.options.format,"en");s+='<div class="day',s+=(n.$active_date===d?" calendar-active":"")+'" date-val="'+d+'">'+a+"</div>",a++}s+="</td>"}if(a>l)break;s+='</tr><tr class="calendar-body">'}s+="</tr></table>",n.$calendarHTML=s}function v(){if(console.log("buildEventListHTML()"),null!=n.options.calendarEvents){var e='<div class="event-header"><p>'+n.formatDate(new Date(n.$active_date),n.options.eventHeaderFormat,"en")+"</p></div>",a=!1;e+="<div>";for(var t=0;t<n.options.calendarEvents.length;t++)if(n.$active_date===n.options.calendarEvents[t].date)a=!0,e+='<div class="event-container">',e+='<div class="event-icon"><div class="event-bullet-'+n.options.calendarEvents[t].type+'"></div></div>',e+='<div class="event-info"><p>'+n.options.calendarEvents[t].name+"</p></div>",e+="</div>";else if(n.options.calendarEvents[t].everyYear){n.formatDate(new Date(n.$active_date),"mm/dd","en")==n.formatDate(new Date(n.options.calendarEvents[t].date),"mm/dd","en")&&(a=!0,e+='<div class="event-container">',e+='<div class="event-icon"><div class="event-bullet-'+n.options.calendarEvents[t].type+'"></div></div>',e+='<div class="event-info"><p>'+n.options.calendarEvents[t].name+"</p></div>",e+="</div>")}a||(e+="<p>No event for this day.. so take a rest! :)</p>"),e+="</div>",n.$eventHTML=e}}"all"==e?(!function(){var e='<div class="calendar-sidebar"></div><div class="calendar-inner"></div><div class="calendar-events"></div>';n.options.canAddEvent&&(e+='<span id="eventAddButton" title="Add event">ADD EVENT</span>'),n.options.eventListToggler&&(e+='<span id="eventListToggler" title="Close event list"><button class="icon-button"><span class="chevron-arrow-right"></span></button></span>'),n.$mainHTML=e}(),d(),c(),v()):"sidebar"==e?d():"inner"==e?(console.log("buildCalendar---inner",n.options.calendarEvents),c()):"events"==e&&v(),n.setHTML(e)},a.prototype.setHTML=function(a){var t=this;"all"==a?(t.$calendar.html(t.$mainHTML),t.$calendar_sidebar=e(".calendar-sidebar"),t.$calendar_inner=e(".calendar-inner"),t.$calendar_events=e(".calendar-events"),t.$calendar_sidebar.html(t.$sidebarHTML),t.$calendar_inner.html(t.$calendarHTML),t.$calendar_events.html(t.$eventHTML)):"sidebar"==a?(t.$calendar_sidebar=e(".calendar-sidebar"),t.$calendar_sidebar.html(t.$sidebarHTML)):"inner"==a?(t.$calendar_inner=e(".calendar-inner"),t.$calendar_inner.html(t.$calendarHTML)):"events"==a&&(t.$calendar_events=e(".calendar-events"),t.$calendar_events.html(t.$eventHTML)),null!=t.options.calendarEvents&&t.initCalendarEvents(),t.options.todayHighlight&&e('.day[date-val="'+t.formatDate(t.$cal_months_labels[t.$month]+"/"+t.$cal_current_date.getDate()+"/"+t.$year,t.options.format,"en")+'"]').addClass("calendar-today"),t.initEventListener()},a.prototype.initCalendarEvents=function(){var a=this;e(".event-indicator").empty();var t=a.$cal_days_in_month[a.$active_month];1==a.$active_month&&(a.$active_year%4==0&&a.$active_year%100!=0||a.$active_year%400==0)&&(t=29);for(var n=0;n<a.options.calendarEvents.length;n++)for(var r=0;r<t;r++){var l=a.formatDate(new Date(a.$cal_months_labels[a.$active_month]+"/"+(r+1)+"/"+a.$active_year),a.options.format,"en"),i=e('[date-val="'+l+'"]');if(l==a.options.calendarEvents[n].date){if(i.addClass("calendar-"+a.options.calendarEvents[n].type),0==e('[date-val="'+l+'"] span.event-indicator').length&&i.append('<span class="event-indicator"></span>'),0==e('[date-val="'+l+'"] span.event-indicator > .type-bullet > .type-'+a.options.calendarEvents[n].type).length){var o='<div class="type-bullet"><div class="type-'+a.options.calendarEvents[n].type+'"></div></div>';i.find(".event-indicator").append(o)}}else if(a.options.calendarEvents[n].everyYear){if(a.formatDate(new Date(l),"mm/dd","en")==a.formatDate(new Date(a.options.calendarEvents[n].date),"mm/dd","en")&&(i.addClass("calendar-"+a.options.calendarEvents[n].type),0==e('[date-val="'+l+'"] span.event-indicator').length&&i.append('<span class="event-indicator"></span>'),0==e('[date-val="'+l+'"] span.event-indicator > .type-bullet > .type-'+a.options.calendarEvents[n].type).length)){o='<div class="type-bullet"><div class="type-'+a.options.calendarEvents[n].type+'"></div></div>';i.find(".event-indicator").append(o)}}}},a.prototype.initEventListener=function(){var a=this;a.options.sidebarToggler&&e("#sidebarToggler").off("click.evocalendar").on("click.evocalendar",a.toggleSidebar),a.options.eventListToggler&&e("#eventListToggler").off("click.evocalendar").on("click.evocalendar",a.toggleEventList),a.options.canAddEvent&&e("#eventAddButton").off("click.evocalendar").on("click.evocalendar",a.options.onAddEvent),e("[date-val]").off("click.evocalendar").on("click.evocalendar",a.selectDate).on("click.evocalendar",a.options.onSelectDate),e("[month-val]").off("click.evocalendar").on("click.evocalendar",a.selectMonth),e("[year-val]").off("click.evocalendar").on("click.evocalendar",a.selectYear)},a.prototype.selectYear=function(a){var t=this;t.$active_year_el=e(a.currentTarget),"prev"==e(a.currentTarget).attr("year-val")?--t.$active_year:"next"==e(a.currentTarget).attr("year-val")&&++t.$active_year,e("[year-val]").removeClass("active-year"),e(t.$active_year_el).addClass("active-year"),e(".calendar-year p").text(t.$active_year),t.buildCalendar("inner",null,t.$active_year)},a.prototype.selectMonth=function(a){var t=this;t.$active_month=e(a.currentTarget).attr("month-val"),t.$active_month_el=e("li[month-val="+t.$active_month+"]"),e(t.$active_month_el).addClass("active-month"),e("[month-val]").removeClass("active-month"),e("[month-val="+t.$active_month+"]").addClass("active-month"),t.buildCalendar("inner",t.$active_month)},a.prototype.selectDate=function(a){var t=this;t.$active_day_el=e(a.currentTarget),t.$active_date=t.$active_day_el.attr("date-val"),e(".day").removeClass("calendar-active"),e(t.$active_day_el).addClass("calendar-active"),t.buildCalendar("events")},a.prototype.toggleSidebar=function(a){var t=this;e(t.$calendar).hasClass("sidebar-hide")?e(t.$calendar).removeClass("sidebar-hide"):e(t.$calendar).addClass("sidebar-hide")},a.prototype.toggleEventList=function(a){var t=this;e(t.$calendar).hasClass("event-hide")?e(t.$calendar).removeClass("event-hide"):e(t.$calendar).addClass("event-hide")},a.prototype.addCalendarEvent=function(e){for(var a=this,t=e,n=0;n<t.length;n++)a.isValidDate(t[n].date)&&(t[n].date=a.formatDate(new Date(t[n].date),a.options.format,"en"),a.options.calendarEvents.push(t[n]));a.buildCalendar("inner"),a.buildCalendar("events")},a.prototype.parseFormat=function(e){if("function"==typeof e.toValue&&"function"==typeof e.toDisplay)return e;var a=e.replace(this.initials.validParts,"\0").split("\0"),t=e.match(this.initials.validParts);if(!a||!a.length||!t||0===t.length)throw new Error("Invalid date format.");return{separators:a,parts:t}},a.prototype.isValidDate=function(e){return new Date(e)&&!isNaN(new Date(e).getTime())},a.prototype.formatDate=function(a,t,n){var r=this;if(!a)return"";if("string"==typeof t&&(t=r.parseFormat(t)),t.toDisplay)return t.toDisplay(a,t,n);var l={d:new Date(a).getDate(),D:r.initials.dates[n].daysShort[new Date(a).getDay()],DD:r.initials.dates[n].days[new Date(a).getDay()],m:new Date(a).getMonth()+1,M:r.initials.dates[n].monthsShort[new Date(a).getMonth()],MM:r.initials.dates[n].months[new Date(a).getMonth()],yy:new Date(a).getFullYear().toString().substring(2),yyyy:new Date(a).getFullYear()};l.dd=(l.d<10?"0":"")+l.d,l.mm=(l.m<10?"0":"")+l.m,a=[];for(var i=e.extend([],t.separators),o=0,s=t.parts.length;o<=s;o++)i.length&&a.push(i.shift()),a.push(l[t.parts[o]]);return a.join("")},e.fn.evoCalendar=function(){var e,t,n=this,r=arguments[0],l=Array.prototype.slice.call(arguments,1),i=n.length;for(e=0;e<i;e++)if("object"==typeof r||void 0===r?n[e].evoCalendar=new a(n[e],r):t=n[e].evoCalendar[r].apply(n[e].evoCalendar,l),void 0!==t)return t;return n}}));